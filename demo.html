<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2048æ¸¸æˆ - æ¸²æŸ“å™¨æ¼”ç¤º</title>
    <link rel="stylesheet" href="styles/main.css">
    <style>
        .demo-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .demo-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        
        .demo-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .demo-button {
            background: #8f7a66;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .demo-button:hover {
            background: #9f8a76;
        }
        
        .demo-info {
            background: #f8f8f8;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <h1>2048æ¸¸æˆ - æ¸²æŸ“å™¨æ¼”ç¤º</h1>
        
        <div class="demo-section">
            <h2>æ¸¸æˆç•Œé¢</h2>
            <div class="game-container">
                <!-- æ¸¸æˆæ ‡é¢˜å’Œåˆ†æ•°åŒºåŸŸ -->
                <header class="game-header">
                    <h1 class="game-title">2048</h1>
                    <div class="score-container">
                        <div class="score-box">
                            <div class="score-label">åˆ†æ•°</div>
                            <div class="score-value" id="current-score">0</div>
                        </div>
                        <div class="score-box">
                            <div class="score-label">æœ€é«˜åˆ†</div>
                            <div class="score-value" id="best-score">0</div>
                        </div>
                    </div>
                </header>

                <!-- æ¸¸æˆç½‘æ ¼å®¹å™¨ -->
                <div class="grid-container">
                    <!-- èƒŒæ™¯ç½‘æ ¼ -->
                    <div class="grid-background">
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                        <div class="grid-cell"></div>
                    </div>
                    
                    <!-- æ¸¸æˆæ–¹å—å®¹å™¨ -->
                    <div class="tile-container" id="tile-container">
                        <!-- åŠ¨æ€ç”Ÿæˆçš„æ–¹å—å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                    </div>
                </div>

                <!-- æ¸¸æˆçŠ¶æ€æ¶ˆæ¯ -->
                <div class="game-message" id="game-message">
                    <div class="message-content">
                        <div class="message-text" id="message-text"></div>
                        <button class="try-again-button" id="try-again-btn">å†è¯•ä¸€æ¬¡</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="demo-section">
            <h2>æ¸²æŸ“å™¨æ§åˆ¶</h2>
            <div class="demo-controls">
                <button class="demo-button" onclick="initDemo()">åˆå§‹åŒ–æ¼”ç¤º</button>
                <button class="demo-button" onclick="showSampleGrid()">æ˜¾ç¤ºç¤ºä¾‹ç½‘æ ¼</button>
                <button class="demo-button" onclick="testAnimations()">æµ‹è¯•åŠ¨ç”»</button>
                <button class="demo-button" onclick="showWinMessage()">æ˜¾ç¤ºè·èƒœæ¶ˆæ¯</button>
                <button class="demo-button" onclick="showGameOverMessage()">æ˜¾ç¤ºæ¸¸æˆç»“æŸ</button>
                <button class="demo-button" onclick="clearGrid()">æ¸…ç©ºç½‘æ ¼</button>
            </div>
            <div id="demo-info" class="demo-info">ç‚¹å‡»æŒ‰é’®å¼€å§‹æ¼”ç¤º...</div>
        </div>
    </div>

    <!-- å¼•å…¥JavaScriptæ–‡ä»¶ -->
    <script src="js/GameState.js"></script>
    <script src="js/MoveProcessor.js"></script>
    <script src="js/GameEngine.js"></script>
    <script src="js/GameRenderer.js"></script>
    
    <script>
        let demoGameState = null;
        let demoGameEngine = null;
        let demoGameRenderer = null;
        
        // åˆå§‹åŒ–æ¼”ç¤º
        function initDemo() {
            try {
                updateInfo('æ­£åœ¨åˆå§‹åŒ–æ¼”ç¤º...');
                
                // åˆ›å»ºæ¸¸æˆç»„ä»¶
                demoGameState = new GameState();
                demoGameEngine = new GameEngine(demoGameState);
                
                const gameContainer = document.querySelector('.game-container');
                demoGameRenderer = new GameRenderer(gameContainer);
                
                // åˆå§‹åŒ–æ¸¸æˆ
                demoGameEngine.initGame();
                demoGameRenderer.render(demoGameState);
                
                updateInfo('æ¼”ç¤ºåˆå§‹åŒ–å®Œæˆï¼æ¸¸æˆå·²å¼€å§‹ï¼ŒåŒ…å«2ä¸ªéšæœºæ–¹å—ã€‚');
            } catch (error) {
                updateInfo('åˆå§‹åŒ–å¤±è´¥: ' + error.message);
                console.error(error);
            }
        }
        
        // æ˜¾ç¤ºç¤ºä¾‹ç½‘æ ¼
        function showSampleGrid() {
            try {
                if (!demoGameState || !demoGameRenderer) {
                    updateInfo('è¯·å…ˆåˆå§‹åŒ–æ¼”ç¤ºï¼');
                    return;
                }
                
                updateInfo('æ˜¾ç¤ºç¤ºä¾‹ç½‘æ ¼...');
                
                // è®¾ç½®ç¤ºä¾‹ç½‘æ ¼
                const sampleGrid = [
                    [2, 4, 8, 16],
                    [32, 64, 128, 256],
                    [512, 1024, 2048, 0],
                    [0, 0, 0, 4096]
                ];
                
                demoGameState.setGrid(sampleGrid);
                demoGameState.setScore(12345);
                demoGameState.setBestScore(54321);
                
                demoGameRenderer.render(demoGameState);
                
                updateInfo('ç¤ºä¾‹ç½‘æ ¼å·²æ˜¾ç¤ºï¼åŒ…å«ä»2åˆ°4096çš„å„ç§æ–¹å—ã€‚');
            } catch (error) {
                updateInfo('æ˜¾ç¤ºç¤ºä¾‹ç½‘æ ¼å¤±è´¥: ' + error.message);
                console.error(error);
            }
        }
        
        // æµ‹è¯•åŠ¨ç”»
        function testAnimations() {
            try {
                if (!demoGameRenderer) {
                    updateInfo('è¯·å…ˆåˆå§‹åŒ–æ¼”ç¤ºï¼');
                    return;
                }
                
                updateInfo('æµ‹è¯•åŠ¨ç”»æ•ˆæœ...');
                
                // æµ‹è¯•æ–°æ–¹å—åŠ¨ç”»
                demoGameRenderer.animateNewTile(0, 0, 2).then(() => {
                    return demoGameRenderer.animateNewTile(1, 1, 4);
                }).then(() => {
                    return demoGameRenderer.animateMerge({row: 0, col: 0}, 4);
                }).then(() => {
                    updateInfo('åŠ¨ç”»æµ‹è¯•å®Œæˆï¼å±•ç¤ºäº†æ–°æ–¹å—å‡ºç°å’Œåˆå¹¶åŠ¨ç”»ã€‚');
                });
                
            } catch (error) {
                updateInfo('åŠ¨ç”»æµ‹è¯•å¤±è´¥: ' + error.message);
                console.error(error);
            }
        }
        
        // æ˜¾ç¤ºè·èƒœæ¶ˆæ¯
        function showWinMessage() {
            try {
                if (!demoGameRenderer) {
                    updateInfo('è¯·å…ˆåˆå§‹åŒ–æ¼”ç¤ºï¼');
                    return;
                }
                
                demoGameRenderer.showMessage('ğŸ‰ æ­å–œï¼ä½ è¾¾åˆ°äº†2048ï¼\nç‚¹å‡»"ç»§ç»­æ¸¸æˆ"å¯ä»¥ç»§ç»­æŒ‘æˆ˜æ›´é«˜åˆ†æ•°ã€‚');
                updateInfo('æ˜¾ç¤ºè·èƒœæ¶ˆæ¯');
            } catch (error) {
                updateInfo('æ˜¾ç¤ºè·èƒœæ¶ˆæ¯å¤±è´¥: ' + error.message);
                console.error(error);
            }
        }
        
        // æ˜¾ç¤ºæ¸¸æˆç»“æŸæ¶ˆæ¯
        function showGameOverMessage() {
            try {
                if (!demoGameRenderer) {
                    updateInfo('è¯·å…ˆåˆå§‹åŒ–æ¼”ç¤ºï¼');
                    return;
                }
                
                demoGameRenderer.showMessage('ğŸ’€ æ¸¸æˆç»“æŸï¼\næœ€ç»ˆåˆ†æ•°ï¼š12345');
                updateInfo('æ˜¾ç¤ºæ¸¸æˆç»“æŸæ¶ˆæ¯');
            } catch (error) {
                updateInfo('æ˜¾ç¤ºæ¸¸æˆç»“æŸæ¶ˆæ¯å¤±è´¥: ' + error.message);
                console.error(error);
            }
        }
        
        // æ¸…ç©ºç½‘æ ¼
        function clearGrid() {
            try {
                if (!demoGameRenderer) {
                    updateInfo('è¯·å…ˆåˆå§‹åŒ–æ¼”ç¤ºï¼');
                    return;
                }
                
                demoGameRenderer.clearAllTiles();
                demoGameRenderer.hideMessage();
                updateInfo('ç½‘æ ¼å·²æ¸…ç©º');
            } catch (error) {
                updateInfo('æ¸…ç©ºç½‘æ ¼å¤±è´¥: ' + error.message);
                console.error(error);
            }
        }
        
        // æ›´æ–°ä¿¡æ¯æ˜¾ç¤º
        function updateInfo(message) {
            const infoElement = document.getElementById('demo-info');
            if (infoElement) {
                infoElement.textContent = new Date().toLocaleTimeString() + ': ' + message;
            }
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            updateInfo('é¡µé¢åŠ è½½å®Œæˆï¼Œç‚¹å‡»"åˆå§‹åŒ–æ¼”ç¤º"å¼€å§‹ã€‚');
        });
    </script>
</body>
</html>
